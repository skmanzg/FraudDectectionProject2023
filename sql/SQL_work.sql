-- 문제 case 전체 160만개 데이터에서 8151개 출력 (문제 발견)-- IS_FRAUD has only 8151 out of 1.6M data set. (problem!)SELECT count(IS_FRAUD) from FD WHERE IS_FRAUD = 1;  -- TRANS_NUM 고유값 기준 중복 데이터 검사 (결과: 중복 없음)-- duplicate data check based on TRANS_NUM(unique data) -> no duplicate result!SELECT TRANS_NUM, count(*) FROM FDGROUP BY TRANS_NUMHAVING count(*) > 1;   -- query test before updating table for TRANS_DATE_TRANS_TIME column.select (case when instr(TRANS_DATE_TRANS_TIME , '-') > 1 then              to_char(to_date(TRANS_DATE_TRANS_TIME , 'YYYY-MM-DD HH24:MI:SS'),'MM/DD/YYYY HH24:MI')         else to_char(to_date(TRANS_DATE_TRANS_TIME , 'MM/DD/YYYY HH24:MI'), 'MM/DD/YYYY HH24:MI')         end) field_as_date  from fd;-- 해당 내용을 바탕으로 'MM/DD/YYYY HH24:MI' 업데이트-- update 'MM/DD/YYYY HH24:MI' based on query test above.UPDATE fdSET TRANS_DATE_TRANS_TIME = case when instr(TRANS_DATE_TRANS_TIME , '-') > 1 then              to_char(to_date(TRANS_DATE_TRANS_TIME , 'YYYY-MM-DD HH24:MI:SS'),'MM/DD/YYYY HH24:MI')         else to_char(to_date(TRANS_DATE_TRANS_TIME , 'MM/DD/YYYY HH24:MI'), 'MM/DD/YYYY HH24:MI')         end;-- 'YYYY-MM-DD HH24:MI:SS'형태인 행이 'MM/DD/YYYY HH24:MI'로 변환되었는지 확인 -- check if it is well transformed.select * from (select rownum as num, trans_date_trans_time from fd) a where a.num=1048680;-- null 제외한 개수 세기, 전체 데이터 1604294와 비교 -> 1604294로 전체 데이터 출력. null 없음.-- null check again to see if it is 1604294 -> output is 1604294. it means there is no null.select count(trans_date_trans_time)  from fd; --  => 1604294로 전체 데이터 출력. null 없음.-- query test before updating table for DOB columnselect (case when instr(DOB , '-') > 1 then              to_char(to_date(DOB , 'YYYY-MM-DD'),'MM/DD/YYYY')         else to_char(to_date(DOB , 'MM/DD/YYYY'), 'MM/DD/YYYY')         end) Tdob  from fd;   -- 해당 내용을 바탕으로 'MM/DD/YYYY' 업데이트-- update 'MM/DD/YYYY' based on query test above.UPDATE fdSET DOB = case when instr(DOB , '-') > 1 then              to_char(to_date(DOB , 'YYYY-MM-DD'),'MM/DD/YYYY')         else to_char(to_date(DOB , 'MM/DD/YYYY'), 'MM/DD/YYYY')         end;        -- 'YYYY-MM-DD'형태인 행이 'MM/DD/YYYY'로 변환되었는지 확인 -- check if it is well transformed.select * from (select rownum as num, DOB from fd) a where a.num=1604289;-- null 제외한 개수 세기, 전체 데이터 1604294와 비교 -> 1604294로 전체 데이터 출력. null 없음.-- null check again to see if it is 1604294 -> output is 1604294. it means there is no null.select count(DOB)  from fd; --최종 table update!commit  